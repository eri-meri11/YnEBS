{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{loginWithGoogle,logout,checkAuthState}from\"./auth\";import{db}from\"./firebase\";import{doc,getDoc}from\"firebase/firestore\";import{uploadToIPFS,fetchFromIPFS}from\"./storage\";// Pinata ile IPFS yükleme ve okuma\nimport{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";const App=()=>{const[user,setUser]=useState(null);const[role,setRole]=useState(null);const[tcKimlik,setTcKimlik]=useState(\"\");const[notlar,setNotlar]=useState(\"\");const[ogrenciNot,setOgrenciNot]=useState(\"\");const[hash,setHash]=useState(\"\");useEffect(()=>{checkAuthState(async loggedUser=>{setUser(loggedUser);if(loggedUser){await getUserRole(loggedUser.uid);}});},[]);const getUserRole=async uid=>{const userRef=doc(db,\"users\",uid);const userSnap=await getDoc(userRef);if(userSnap.exists()){setRole(userSnap.data().role);}else{setRole(\"student\");}};const handleAddGrade=async()=>{if(!user)return alert(\"Önce giriş yapın!\");const data={tcKimlik,notlar:notlar.split(\",\")};// Notları listeye çevir\nconst ipfsHash=await uploadToIPFS(data);if(ipfsHash){setHash(ipfsHash);alert(\"Veriler ba\\u015Far\\u0131yla IPFS'e y\\xFCklendi! Hash: \".concat(ipfsHash));}else{alert(\"Yükleme başarısız oldu!\");}};const handleCheckGrade=async()=>{if(!hash)return alert(\"Önce bir hash girin!\");const data=await fetchFromIPFS(hash);if(data&&data.tcKimlik===tcKimlik){setOgrenciNot(data.notlar.join(\", \"));}else{alert(\"Veri bulunamadı veya hatalı TC Kimlik No!\");}};return/*#__PURE__*/_jsx(\"div\",{children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Ho\\u015F geldin, \",user.displayName]}),/*#__PURE__*/_jsx(\"button\",{onClick:logout,children:\"\\xC7\\u0131k\\u0131\\u015F Yap\"}),role===\"teacher\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Not Ekle\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\xD6\\u011Frenci TC Kimlik No\",value:tcKimlik,onChange:e=>setTcKimlik(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Notlar\\u0131 virg\\xFClle ay\\u0131rarak gir (\\xF6rn: 90,85,78)\",value:notlar,onChange:e=>setNotlar(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAddGrade,children:\"Notu Kaydet\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Notlar\\u0131 G\\xF6r\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"TC Kimlik No\",value:tcKimlik,onChange:e=>setTcKimlik(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCheckGrade,children:\"Notlar\\u0131 G\\xF6ster\"}),ogrenciNot&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Notlar: \",ogrenciNot]})]})]}):/*#__PURE__*/_jsx(\"button\",{onClick:loginWithGoogle,children:\"Google ile Giri\\u015F Yap\"})});};export default App;","map":{"version":3,"names":["React","useState","useEffect","loginWithGoogle","logout","checkAuthState","db","doc","getDoc","uploadToIPFS","fetchFromIPFS","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","App","user","setUser","role","setRole","tcKimlik","setTcKimlik","notlar","setNotlar","ogrenciNot","setOgrenciNot","hash","setHash","loggedUser","getUserRole","uid","userRef","userSnap","exists","data","handleAddGrade","alert","split","ipfsHash","concat","handleCheckGrade","join","children","displayName","onClick","type","placeholder","value","onChange","e","target"],"sources":["/home/ege/web/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { loginWithGoogle, logout, checkAuthState } from \"./auth\";\nimport { db } from \"./firebase\";\nimport { doc, getDoc } from \"firebase/firestore\";\nimport { uploadToIPFS, fetchFromIPFS } from \"./storage\"; // Pinata ile IPFS yükleme ve okuma\n\nconst App = () => {\n  const [user, setUser] = useState(null);\n  const [role, setRole] = useState(null);\n  const [tcKimlik, setTcKimlik] = useState(\"\");\n  const [notlar, setNotlar] = useState(\"\");\n  const [ogrenciNot, setOgrenciNot] = useState(\"\");\n  const [hash, setHash] = useState(\"\");\n\n  useEffect(() => {\n    checkAuthState(async (loggedUser) => {\n      setUser(loggedUser);\n      if (loggedUser) {\n        await getUserRole(loggedUser.uid);\n      }\n    });\n  }, []);\n\n  const getUserRole = async (uid) => {\n    const userRef = doc(db, \"users\", uid);\n    const userSnap = await getDoc(userRef);\n    if (userSnap.exists()) {\n      setRole(userSnap.data().role);\n    } else {\n      setRole(\"student\");\n    }\n  };\n\n  const handleAddGrade = async () => {\n    if (!user) return alert(\"Önce giriş yapın!\");\n\n    const data = { tcKimlik, notlar: notlar.split(\",\") }; // Notları listeye çevir\n    const ipfsHash = await uploadToIPFS(data);\n\n    if (ipfsHash) {\n      setHash(ipfsHash);\n      alert(`Veriler başarıyla IPFS'e yüklendi! Hash: ${ipfsHash}`);\n    } else {\n      alert(\"Yükleme başarısız oldu!\");\n    }\n  };\n\n  const handleCheckGrade = async () => {\n    if (!hash) return alert(\"Önce bir hash girin!\");\n    \n    const data = await fetchFromIPFS(hash);\n    if (data && data.tcKimlik === tcKimlik) {\n      setOgrenciNot(data.notlar.join(\", \"));\n    } else {\n      alert(\"Veri bulunamadı veya hatalı TC Kimlik No!\");\n    }\n  };\n\n  return (\n    <div>\n      {user ? (\n        <>\n          <h2>Hoş geldin, {user.displayName}</h2>\n          <button onClick={logout}>Çıkış Yap</button>\n\n          {role === \"teacher\" && (\n            <div>\n              <h3>Not Ekle</h3>\n              <input\n                type=\"text\"\n                placeholder=\"Öğrenci TC Kimlik No\"\n                value={tcKimlik}\n                onChange={(e) => setTcKimlik(e.target.value)}\n              />\n              <input\n                type=\"text\"\n                placeholder=\"Notları virgülle ayırarak gir (örn: 90,85,78)\"\n                value={notlar}\n                onChange={(e) => setNotlar(e.target.value)}\n              />\n              <button onClick={handleAddGrade}>Notu Kaydet</button>\n            </div>\n          )}\n\n          <div>\n            <h3>Notları Gör</h3>\n            <input\n              type=\"text\"\n              placeholder=\"TC Kimlik No\"\n              value={tcKimlik}\n              onChange={(e) => setTcKimlik(e.target.value)}\n            />\n            <button onClick={handleCheckGrade}>Notları Göster</button>\n            {ogrenciNot && <p>Notlar: {ogrenciNot}</p>}\n          </div>\n        </>\n      ) : (\n        <button onClick={loginWithGoogle}>Google ile Giriş Yap</button>\n      )}\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}